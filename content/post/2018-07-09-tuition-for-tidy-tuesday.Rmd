---
title: Tuition Increases for Tidy Tuesday
author: Gina Reynolds
date: '2018-07-09'
slug: tuition-for-tidy-tuesday
categories: []
tags: []
header:
  caption: ''
  image: ''
---


Here's the code for my first Tidy Tuesday submission:  

```{r}
library(tidyverse)
library(readxl)
library(lubridate)
df_0 <- read_xlsx("raw_data/us_avg_tuition.xlsx") %>% 
  left_join(data_frame(state.abb, State = state.name))
  
library(ggrepel)

ggplot(df_0) +
  aes(x = `2004-05`, y = `2014-15`, label = state.abb) +
  coord_equal() +
  lims(x = c(0,15000), y = c(0,17000)) +
  geom_abline(slope = 1, intercept = 0, lty = 2) +
  labs(x = "Tuition cost in 2004, USD", y = "Tuition cost in 2014, USD", col = "", title = "Average in-state tuition fees at public 4-year: 2004 and 2014",
       subtitle = "Vis: Gina Reynolds | Data Source: onlinembapage.com") +
  theme_bw(base_family = "serif") +
  # gain
  geom_segment(aes(x=`2004-05`, xend=`2004-05`, y=`2014-15`, yend=`2004-05`, col="Increase from\n2004 to 2014"), alpha = .7)+ 
  #original
  geom_segment(aes(x=`2004-05`, xend=`2004-05`, y=0, yend=`2004-05`, col="2004 Tuition Cost" ), alpha = .7) +
  # colscale
  scale_color_manual(breaks=c("Increase from\n2004 to 2014", "2004 Tuition Cost"),values=c("grey70", "grey30")) +
  # geom_smooth(se = F, method = "lm") +
    geom_point(col = "grey30") +
  ggpmisc::stat_dens2d_filter(geom = "text_repel", keep.fraction = 0.30, size = 3.8) +
  annotate(geom = "text", x = 1700, y = 1700, label = "Average Tuition\nCosts in 2004", angle = 45, size = 2.8) +
  annotate(geom = "text", x = 13300, y = 15200, label = "Increase", angle = 90, size = 2.8) +
  annotate(geom = "segment", x = 12900, y = 12900, xend = 12900, yend = 17000, arrow = arrow(length = unit(0.25, "cm")), col = "darkgrey") +
  annotate(geom = "segment", x = 12900, y = 12900, xend = 12900, yend = 0, 
           arrow = arrow(ends = "both", length = unit(0.15, "cm"), angle = 90), col = "darkgrey") +
  annotate(geom = "text", x = 13300, y = 8000, label = "Cost in 2004", angle = 90, size = 2.8) 

```

